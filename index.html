<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Auto 3D AMV â€” Local Three (Module)</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ðŸŽ¬ Auto 3D AMV â€” Browser + HF Spaces</h1>
      <p>All Three.js served locally. No CDNs.</p>
    </header>

    <section class="controls">
      <div class="col">
        <label>Project Title</label>
        <input id="title" placeholder="My Song"/>
        <label>Style Brief</label>
        <input id="style" value="Fun, upbeat, colorful 3D for kids; Pixar-like; classroom stage"/>
        <label>Lyrics (paste)</label>
        <textarea id="lyrics" rows="8" placeholder="Paste lyrics..."></textarea>
      </div>
      <div class="col">
        <label>Audio (WAV/MP3)</label>
        <input id="audio" type="file" accept=".wav,.mp3"/>

        <!-- Optional override; default is hard-coded in app.module.js -->
        <label>Hugging Face Space URL (optional override)</label>
        <input id="space" placeholder="https://huggingface.co/spaces/Nwt002tech/MuvidGen"/>

        <div class="btns">
          <!-- Fallback inline call if event listener didnâ€™t bind -->
          <button id="genBtn" onclick="window.AMV_generate && window.AMV_generate()">Generate Full Video</button>
          <button id="stopBtn" disabled>Stop</button>
        </div>
        <div class="status" id="status">Page loaded (module build)â€¦</div>
        <div class="download" id="download"></div>
      </div>
    </section>

    <section class="stage">
      <canvas id="stage"></canvas>
    </section>

    <footer>
      <small>Local Three + Import Map; calls your HF Space for backgrounds.</small>
    </footer>
  </div>

  <!-- Import map â†’ resolves bare "three" to your local module -->
  <script type="importmap">
  {
    "imports": {
      "three": "./vendor/three/build/three.module.js"
    }
  }
  </script>

  <!-- Bootloader: visible error if module fails -->
  <script>
  (async function(){
    const s = document.getElementById('status');
    try {
      await import('./app.module.js');
      s.textContent = 'Module imported âœ…';
    } catch (e) {
      console.error(e);
      s.textContent = 'Module import error: ' + (e && e.message ? e.message : e);
    }
  }());
  </script>
</body>
</html>
